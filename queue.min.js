!function(){function n(n){function l(){for(;r=a<f.length&&n>s;){var e=a++,l=f[e],o=t.call(l,1);o.push(u(e)),++s,l[0].apply(null,o)}}function u(n){return function(e,t){--s,null==p&&(null!=e?(p=e,a=g=0/0,o()):(f[n]=t,--g?r||l():o()))}}function o(){null!=p?d(p):c?d(p,f):d.apply(null,[p].concat(f))}var i,r,c,f=[],a=0,s=0,g=0,p=null,d=e;return n||(n=1/0),i={defer:function(){return p||(f.push(arguments),++g,l()),i},await:function(n){return d=n,c=!1,g||o(),i},awaitAll:function(n){return d=n,c=!0,g||o(),i},remaining:function(){return g},drain:function(){console.log("drain"),console.log("remaining = ",g,"tasks.length=",f.length),f.splice(f.length-g,g),g=0,console.log("remaining = ",g,"tasks.length=",f.length)}}}function e(){}var t=[].slice;n.version="1.0.7","function"==typeof define&&define.amd?define(function(){return n}):"object"==typeof module&&module.exports?module.exports=n:this.queue=n}();